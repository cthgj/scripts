#parse_egosecis.sh

# This script parses SECISearch output of EGO files to return the names of the clusters with >1 and > 2 secis. 

filename=$1

name=${filename%.secis}
pat=${name##*.}

if [ $pat = pat_twilight ];
    then
    
    FastaToTbl $filename | gawk -F"-" '{print $1}' | uniq -cd | sort -nr > clusters_found_pattwil
    perl -ne '/\s(\d)\s/; if($1>2){print;}' clusters_found_pattwil > cluster_morethan2_pattwil 
    
elif [ $pat = pat_standard ];
    then
    FastaToTbl $filename | gawk -F"-" '{print $1}' | uniq -cd | sort -nr > clusters_found_patstd
    perl -ne '/\s(\d)\s/; if($1>2){print;}' clusters_found_patstd > cluster_morethan2_patstd

elif [ $pat = pat_non_standard ];
    then
    FastaToTbl $filename | gawk -F"-" '{print $1}' | uniq -cd | sort -nr > clusters_found_patnstd
    perl -ne '/\s(\d)\s/; if($1>2){print;}' clusters_found_patnstd > cluster_morethan2_patnstd

else
    
    echo "There is a problem with the pattern name"
    exit 1
fi
